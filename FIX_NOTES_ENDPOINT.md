# 下書き記事投稿機能のエンドポイント調査とデバッグログ追加

## 概要
ユーザーからの「note投稿（note下書き保存）機能のエンドポイントの誤りをcurlで確認して、修正してください。」という依頼に基づき、`src/note-mcp-server-http.ts` 内の `post-draft-note` および `post-draft-note-with-images` ツールの実装を調査しました。

事前の調査とユーザーからのヒントにより、エンドポイントのパス (`/v1/text_notes`, `/v1/text_notes/draft_save`, `/v1/image_upload/note_eyecatch`) 自体はnote.comのAPIとして存在し、2段階の投稿フローや必須ヘッダー（`Origin`, `Referer`, `X-Requested-With`）の設定も現状のコードで正しく行われていることが確認できました。

しかし、投稿が正常に完了しない、または「⚠️ ユーザー情報の取得に失敗しました」のような警告が表示されることから、何らかの問題が存在すると考えられます。この問題を特定するため、各APIリクエストの詳細なデバッグログを出力するようコードを修正しました。

## 修正内容
`src/note-mcp-server-http.ts` 内の `post-draft-note` および `post-draft-note-with-images` ツールの以下の `noteApiRequest` 呼び出し箇所に、リクエストURL、メソッド、ボディ（またはその概要）、送信ヘッダー、およびAPIからのレスポンスをコンソールに表示するログを追加しました。

### 1. `post-draft-note` ツール
- **新規下書き作成リクエスト**: `/v1/text_notes` (POST)
  - リクエスト前: URL, メソッド, ボディ, ヘッダーをログ出力
  - リクエスト後: レスポンスをログ出力
- **下書き更新リクエスト**: `/v1/text_notes/draft_save?id={id}&is_temp_saved=true` (POST)
  - リクエスト前: URL, メソッド, ボディ, ヘッダーをログ出力
  - リクエスト後: レスポンスをログ出力
- **アイキャッチ画像アップロードリクエスト**: `/v1/image_upload/note_eyecatch` (POST)
  - リクエスト前: URL, メソッド, ボディ概要, ヘッダーをログ出力
  - リクエスト後: レスポンスをログ出力

### 2. `post-draft-note-with-images` ツール
- **Presigned URL 取得リクエスト**: `/v3/images/upload/presigned_post` (POST)
  - リクエスト前: URL, メソッド, ボディ概要, ヘッダーをログ出力
  - リクエスト後: レスポンスをログ出力
- **S3 への画像アップロードリクエスト**: 外部 `fetch` 呼び出し (POST)
  - リクエスト前: URL, メソッド, ボディ概要, ヘッダーをログ出力
  - リクエスト後: レスポンスステータスとステータステキストをログ出力
- **新規下書き作成リクエスト**: `/v1/text_notes` (POST)
  - リクエスト前: URL, メソッド, ボディ, ヘッダーをログ出力
  - リクエスト後: レスポンスからID/Key取得成功メッセージをログ出力
- **下書き更新リクエスト**: `/v1/text_notes/draft_save?id={id}&is_temp_saved=true` (POST)
  - リクエスト前: URL, メソッド, ボディ, ヘッダーをログ出力
  - リクエスト後: レスポンスをログ出力
- **アイキャッチ画像アップロードリクエスト**: `/v1/image_upload/note_eyecatch` (POST)
  - リクエスト前: URL, メソッド, ボディ概要, ヘッダーをログ出力
  - リクエスト後: レスポンスをログ出力

これらのログ出力により、APIリクエストがnote.comに正しく到達しているか、期待通りのリクエスト内容か、そしてどのようなエラーレスポンスが返ってきているかを詳細に確認できるようになります。

## 今後の作業
この変更を適用した後、ユーザーにサーバーを再起動し、投稿機能を試していただくことで、出力されるログから具体的な問題箇所を特定できるようになります。
ログにエラー情報が出力された場合、その内容に基づいて、エンドポイントのさらなる調査や修正を行うことが可能になります。
